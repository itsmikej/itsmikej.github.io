---
layout: default
title: "IP分类和子网掩码"
author: itsmikej
category: TCP/IP
---

IP的分类大概可以分成3个阶段

## 分类IP

这是IP协议最初的分类标准。它将IP分成了4类，如下图所示：
![IP分类][1]

一个IP地址被定义为**{网络号：主机号}**，这样做为了更好的满足用户需求，因为有的网络大，有很多主机，需要很多IP，而有的网络则很少。

## 划分子网

为了解决IP地址空间利用率很低的问题，一个A类地址网络的主机数超过1000万台，一个B类地址网络也有超过6万台，很多网络根本达不到这个量，而C类地址又太少。同时这样也会导致**路由表太大**，使网络性能变坏。

针对这些问题，在一个拥有许多物理网络的单位（比如大的ISP），在IP地址中又增加了一个**子网号字段**，新的定义为三级编址：**{网络号：子网号：主机号}**。

那么路由器如何将数据报转发到子网中呢？答案是**子网掩码**，计算方式如下图：
![子网掩码][2]

使用子网掩码的好处是，不管网络有没有划分子网，只要把子网掩码和IP地址进行逐位的与运算，就能立即得出网络地址。

RFC规定，路由器在和相邻路由器交换信息时，必须把自己的子网掩码告诉相邻的路由器。

## 构成超网（CIDR）

划分子网仍然无法解决传统地址分类利用率很低的问题。于是出现了CIDR，融合了前两个阶段的优点。它的记法是**{网络前缀：主机号}**，又回到了两级编址。下图是一个CIDR地址分配的例子：
![CIDR地址分配][3]

图中斜线后的数字网络前缀所占的位数，CIDR中没有子网号，但也通过子网掩码的方式来划分网段。

这样一来，CIDR就可以更好的分配IPv4的地址空间，可以根据客户需要分配适当的长度的网络前缀。而在传统的分类方式，只能通过/8，/16，/24来分配，很不灵活。

  [1]: http://ww4.sinaimg.cn/large/77691203gw1fav48uw2x1j20du07kwf5.jpg
  [2]: http://ww4.sinaimg.cn/large/77691203gw1fav5mxgceyj20hl0abjsy.jpg
  [3]: http://ww3.sinaimg.cn/large/77691203gw1fav6ck24opj20i20bqtac.jpg
